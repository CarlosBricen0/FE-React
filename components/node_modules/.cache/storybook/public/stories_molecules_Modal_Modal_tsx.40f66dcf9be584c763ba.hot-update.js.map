{"version":3,"file":"stories_molecules_Modal_Modal_tsx.40f66dcf9be584c763ba.hot-update.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAOA;AAOA;AAAA;AAAA;AAAA;AAuDA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AAAA;AACA;AAAA;AAGA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAAA;AACA;AAAA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AAGA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AAGA;AAIA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAKA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAKA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAAA;AACA;AAIA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAIA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAEA;AACA;AAEA;AAAA;AAAA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAMA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAEA;AAGA","sources":["webpack://components/./stories/molecules/Modal/Modal.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react'\nimport classNames from 'classnames'\nimport { getGlobalStyle } from '../../../helpers'\nimport {\n  FontSize,\n  Icon,\n  IconProps,\n  Text\n} from '../../atoms'\nimport { JustifyContent, Position } from '../../layout/BaseContainer/BaseContainer'\nimport {\n  Column,\n  Container,\n  Row,\n  Spacer\n} from '../../layout'\nimport { Site } from '../../../shared/interfaces/Site'\nimport styles from './Modal.module.css'\n\ninterface ModalProps {\n  adjusted?: boolean;\n  backgroundColor?: string;\n  borderRadius?: string;\n  children: React.ReactNode;\n  className?: string;\n  color?: string;\n  colorButtonDrag?: string;\n  customCssFullScreen?: boolean;\n  customIcon?:IconProps['name'];\n  customIconPadding?: string;\n  dragRatio?: number;\n  errorModal?: boolean;\n  fontSizeMobile?: FontSize;\n  fullScreen?: boolean;\n  halfScreen?: boolean;\n  height?: string;\n  hiddenX?: boolean;\n  hideOverlay?: boolean;\n  iconPadding?: string;\n  iconProps?: Omit<IconProps, 'name'>;\n  iconSize?: IconProps['customSize'];\n  isCloseIcon?: boolean;\n  isDraggable?: boolean;\n  isOpen: boolean;\n  justifyContent?: JustifyContent;\n  level?: '1' | '2' | '3';\n  marginFullScreen?: string;\n  maxHeight?: string;\n  maxHeightFullScreen?: string;\n  maxWidth?: string;\n  minFullscreenTranslation?: number;\n  minHeight?: string;\n  minHeightFullScreen?: string;\n  modalTitle?: string;\n  padding?: string;\n  position?: Position;\n  site?: Site;\n  sizeIconClose?: number;\n  titleModalMobile?: boolean;\n  top?: string;\n  widthButtonDrag?: string;\n  toggle?: () => void;\n  toggleOutside?: () => void;\n}\n\ninterface DragProps {\n  dragStartLeft: number;\n  dragStartTop: number;\n  dragStartX: number;\n  dragStartY: number;\n  transalteY: number;\n}\nexport const ID_MODAL_HANDLER = 'modal_handler'\nexport const ID_MODAL_ACTION = 'modal_handler_action'\n\nexport const Modal = ({\n  adjusted,\n  backgroundColor = getGlobalStyle('--color-base-white'),\n  borderRadius = getGlobalStyle('--border-radius-md'),\n  children,\n  className,\n  color='white',\n  colorButtonDrag = getGlobalStyle('--color-neutral-gray-silver'),\n  customCssFullScreen,\n  customIcon = 'AlertIcon',\n  customIconPadding = '0px',\n  dragRatio = 0.5,\n  errorModal,\n  fontSizeMobile,\n  fullScreen,\n  halfScreen = false,\n  height = 'initial',\n  hiddenX = false,\n  hideOverlay = false,\n  iconPadding,\n  iconProps,\n  iconSize = 26.5,\n  isCloseIcon = true,\n  isDraggable = true,\n  isOpen = false,\n  justifyContent,\n  level,\n  marginFullScreen = '60px 0 0 0',\n  maxHeight = 'initial',\n  maxHeightFullScreen,\n  maxWidth = '315px',\n  minFullscreenTranslation = 0,\n  minHeight = '20%',\n  minHeightFullScreen = 'calc(100vh - 60px)',\n  modalTitle = '',\n  padding = '20px',\n  position = null,\n  site = 'unimarc',\n  sizeIconClose = 14,\n  titleModalMobile = false,\n  top,\n  widthButtonDrag = '45px',\n  toggle,\n  toggleOutside = () => { return }\n}: ModalProps): React.ReactElement => {\n  const modalRef = useRef<HTMLDivElement>(null)\n  const dragProps = useRef<DragProps>()\n\n  const handleDragStart = (e: React.TouchEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    const { clientX, clientY } = e.touches[0]\n    const { offsetTop, offsetLeft } = modalRef.current\n    const { left, top } = modalRef.current.getBoundingClientRect()\n\n    dragProps.current = {\n      dragStartLeft: left - offsetLeft,\n      dragStartTop: top - offsetTop,\n      dragStartX: clientX,\n      dragStartY: clientY,\n      transalteY: 0\n    }\n\n    window.addEventListener('touchmove', handleDrag, false)\n    window.addEventListener('touchend', handleDragEnd, false)\n  }\n\n  const handleDragEnd = () => {\n    const translateAmount = dragProps.current.transalteY\n    const bodyHeight = halfScreen ? document.body.clientHeight / 4 : document.body.clientHeight\n    const maxTranslation = dragRatio * bodyHeight\n\n    if (minFullscreenTranslation && translateAmount > maxTranslation) {\n      const originTranslateAmount = minFullscreenTranslation !== 0 ? translateAmount : minFullscreenTranslation\n\n      const animation = modalRef.current.animate(\n        [\n          { transform: `translateY(${originTranslateAmount}px)` },\n          { transform: `translateY(${minFullscreenTranslation}px)` }\n        ],\n        {\n          duration: 200\n        }\n      )\n\n      animation.addEventListener('finish', () => {\n        dragProps.current.transalteY = minFullscreenTranslation\n        modalRef.current.style.transform = `translateY(${minFullscreenTranslation}px)`\n      })\n\n      animation.addEventListener('finish', () => {\n        toggleOutside()\n      })\n    }\n\n    if (translateAmount < maxTranslation && translateAmount > 0) {\n      const animation = modalRef.current.animate(\n        [\n          { transform: `translateY(${translateAmount}px)` },\n          { transform: `translateY(0px)` }\n        ],\n        {\n          duration: 200\n        }\n      )\n      animation.addEventListener('finish', () => {\n        dragProps.current.transalteY = 0\n        modalRef.current.style.transform = 'translateY(0px)'\n      })\n    }\n\n    window.removeEventListener('touchmove', handleDrag, false)\n    window.removeEventListener('touchend', handleDragEnd, false)\n  }\n\n  const handleDrag = (e: TouchEvent) => {\n    e.preventDefault()\n    if (!e.touches?.length) return\n\n    const { clientY } = e.touches[0]\n    dragProps.current.transalteY =\n      dragProps.current.dragStartTop + clientY - dragProps.current.dragStartY\n\n    if (dragProps.current.transalteY < 0) dragProps.current.transalteY = 0\n\n    modalRef.current.style.transform = `translateY(${dragProps.current.transalteY}px)`\n  }\n\n  const modalIconName = customIcon\n  const modalIconSize = iconSize\n  const isUnimarc: boolean = site === 'unimarc'\n  const classes = `${isUnimarc ? classNames(styles.error_icon) : classNames(styles.error_icon_alvi)}`\n\n  useEffect(() => {\n    if (isOpen && typeof toggleOutside === 'function') window.addEventListener('keyup', e => { return e.code === 'Escape' && toggleOutside() })\n    return () => { return isOpen && window.removeEventListener('keyup', () => { return }) }\n  }, [isOpen])\n\n  return (\n    <>\n      {isOpen ? (\n        <>\n          {/* overlay */}\n          <Container\n            className={classNames(\n              styles.modalBg,\n              'modal__bg',\n              {\n                [styles['modal__customCssFullScreen']]: customCssFullScreen,\n                [styles['modal__fullScreen']]: fullScreen,\n                [styles['modal__hideOverlay']]: hideOverlay,\n                [styles[`modal__level-${level}`]]: !!level\n              }\n            )}\n            maxHeight={null}\n            maxWidth={null}\n            position={position}\n            top={top}\n          >\n            {/* Icon on top of modal */}\n            {\n              (errorModal && isUnimarc) &&\n              <>\n                <div className={classes}>\n                  <Container justifyContent='center' padding={customIconPadding}>\n                    <Icon\n                      color={color}\n                      customSize={modalIconSize}\n                      name={modalIconName}\n                    />\n                  </Container>\n                </div>\n              </>\n            }\n            {\n              (errorModal && !isUnimarc) &&\n              <>\n                <div className={classes}>\n                  <Container justifyContent='center' padding={customIconPadding}>\n                    <Icon\n                      color={color}\n                      customSize={modalIconSize}\n                      name={modalIconName}\n                    />\n                  </Container>\n                </div>\n              </>\n            }\n            <Container\n              customHeight='100%'\n              customWidth='100%'\n              onClick={toggleOutside}\n              position='absolute'\n            />\n            {/* modal container */}\n            <Container\n              alignItems='center'\n              backgroundColor={backgroundColor}\n              borderRadius={borderRadius}\n              customHeight={height}\n              height={height}\n              justifyContent='center'\n              maxHeight={maxHeight}\n              maxWidth={maxWidth}\n              minHeight={minHeight}\n              overflow='hidden'\n              padding={padding}\n              position='relative'\n              ref={modalRef}\n              {...(fullScreen && {\n                width: '100%',\n                margin: marginFullScreen,\n                minHeight: minHeightFullScreen,\n                maxHeight: maxHeightFullScreen,\n                maxWidth: '100%'\n              })}\n              className={\n                classNames(\n                  styles.overflow,\n                  className,\n                  {[styles['modal__adjusted']]: adjusted}\n                )}\n            >\n              {fullScreen && (\n                <Column\n                  id={ID_MODAL_HANDLER}\n                  onTouchStart={isDraggable && handleDragStart}\n                  position='absolute'\n                  top='0'\n                  touchAction={'none'}\n                >\n                  <Container\n                    alignSelf='center'\n                    backgroundColor={colorButtonDrag}\n                    borderRadius={getGlobalStyle('--border-radius-sm')}\n                    clickable={'grab'}\n                    customHeight='6px'\n                    id={ID_MODAL_ACTION}\n                    margin='10px'\n                    width={widthButtonDrag}\n                    zIndex='3'\n                  />\n                  {\n                    titleModalMobile &&\n                    (<>\n                      <Spacer.Horizontal size={12} />\n                      <Row\n                        alignItems='center'\n                        justifyContent={justifyContent}\n                        width='100%'\n                      >\n                        <Text\n                          fontSize={fontSizeMobile}\n                          fontWeight='semibold'\n                          lineHeight='25px'\n                        >\n                          {modalTitle}\n                        </Text>\n                      </Row>\n                      <Spacer.Horizontal size={24} />\n                    </>)\n                  }\n                </Column>\n              )}\n              {/* X button */}\n              {!hiddenX &&\n                <Container\n                  absoluteDefault='topRight'\n                  alignItems='start'\n                  justifyContent='end'\n                  maxWidth='max-content'\n                  onClick={toggle}\n                  padding={iconPadding ?? padding}\n                  position='absolute'\n                  zIndex={'1'}\n                >\n                  {isCloseIcon &&\n                      <div className={classNames({[styles['icon__adjusted']]: adjusted})}>\n                        <Icon\n                          clickable='pointer'\n                          color={getGlobalStyle('--color-icons-gray')}\n                          customSize={sizeIconClose}\n                          name='Close'\n                          {...iconProps}\n                        />\n                      </div>\n                  }\n                </Container>\n              }\n              {/* content */}\n              <Column\n                alignItems='center'\n                customHeight={height}\n                justifyContent={justifyContent}\n              >\n                {children}\n              </Column>\n            </Container>\n          </Container>\n        </>\n      ) : null}\n    </>\n  )\n}"],"names":[],"sourceRoot":""}